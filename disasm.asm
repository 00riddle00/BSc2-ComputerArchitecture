; ============================================================
;  DESCRIPTION
; ============================================================
; Programa: Disasembleris
;
; Uzduoties salyga: 
    ; Programa, kuri priima 'input' faila (.com arba .exe 
    ; pavidalu) ir disasembliuoja i nurodyta 'output' faila
    ; (.asm pavidalu). 

    ; output failas po programos ivykdymo atrodo taip:
        ; 0100:	B409		mov	ah, 09
        ; 0102:	BADE01		mov	dx, 01DE
        ; 0105:	CD21		int	21
        ; 01F9:   65        NEATPAZINTA
        ; ...
    ; t.y. vienoje eiluteje turi buti komandos Hex adresas, 
    ; komandos Hex dump'as ir atpazinta komanda (arba 
    ; NEATPAZINTA, jei tokios komandos nera).
;
; Atliko: Tomas Giedraitis
; ============================================================

; ============================================================
;  MACROS
; ============================================================

include macros.asm

; ============================================================
;  SETTINGS
; ============================================================
.model small     ; one code segment one data segment
.stack 100h
jumps

; ============================================================
;  CONSTANTS
; ============================================================

; ============================================================
;  DATA
; ============================================================

.data
    data_octal        db 2, 1, 2,   0, 1, 6,   1, 4, 4,   0, 0, 1,  0FFh ; B409
    ;data_octal        db 2, 6, 4, 0, 1, 1, 0FFh ; B409
    ;data_octal        db 2, 7, 2, 3, 3, 6, 0, 0, 1, 0FFh ; BADE01

    ;data_octal         db 2, 6, 4, 0, 1, 1
                       ;db 2, 7, 2, 3, 3, 6, 0, 0, 1
                       ;db 2, 3, 5
                       ;db 0, 1, 7
                       ;db 9
                       ;db 0, 3, 3, 0FFh;

    ; Rb = Byte-sized register
    Rb dw 'AL', 'CL', 'DL', 'BL', 'AH', 'CH', 'DL', 'BH'
    ; Rw = Word-sized register
    Rw dw 'AX', 'CX', 'DX', 'BX', 'SP', 'BP', 'SI', 'DI'

    sep1 db '=============================================================================$'

; ============================================================
;  CODE
; ============================================================

.code

; ------------------------------------------------------------
; PROCEDURES
; ------------------------------------------------------------
; ...
; -----------------------------------------------------------/

start:
    mov ax, @data                  ; perkelti data i registra ax
    mov ds, ax                     ; perkelti ax (data) i data segmenta
    mov es, ax                     ; perkelti ax (data) i data segmenta

    ; isvesti programos aprasa
    m_println sep1
    m_puts   '                                   '
    m_puts   'DISASM'
    m_putsln '                                   '
    m_println sep1

    xor ax, ax
    xor si, si

    mov si, 0FFFFh

_xxx:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 0FFh
    je short exit_program

    cmp al, 3
    je _3xx
    ja short undefined_1st_octal

    cmp al, 1
    jb short _0xx
    je _1xx
    jmp _2xx

    jmp short _xxx
; -----------------------------------------------------------/

undefined_1st_octal:
    inc si
    inc si
    jmp short undefined

undefined_2nd_octal:
    inc si
    jmp short undefined

undefined:
    m_putsln 'UNDEFINED'
    jmp short _xxx

exit_program:
    m_exit0

; ============================================================
;  _0XX
; ============================================================
_0xx:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _07x
    ja short undefined_2nd_octal

    cmp al, 3
    jb short __0_012_x
    je  _03x
    jmp short __0_456_x

    __0_012_x:
        cmp al, 1
        jb short _00x
        je  _01x
        jmp _02x

    __0_456_x:
        cmp al, 5
        jb _04x
        je  _05x
        jmp _06x

; ------------------------------------------------------------
;  _00X
; ------------------------------------------------------------
_00x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _007
    ja undefined

    cmp al, 3
    jb short __00_012
    je  _003
    jmp short __00_456

    __00_012:
        cmp al, 1
        jb short _000
        je  _001
        jmp _002

    __00_456:
        cmp al, 5
        jb _004
        je  _005
        jmp _006

; ############################################################
_000:
    m_putsln '000'
    jmp _xxx

; ############################################################
_001:
    m_putsln '001'
    jmp _xxx

; ############################################################
_002:
    m_putsln '002'
    jmp _xxx

; ############################################################
_003:
    m_putsln '003'
    jmp _xxx

; ############################################################
_004:
    m_putsln '004'
    jmp _xxx

; ############################################################
_005:
    m_putsln '005'
    jmp _xxx

; ############################################################
_006:
    m_putsln '006'
    jmp _xxx

; ############################################################
_007:
    m_putsln '007'
    jmp _xxx

; ------------------------------------------------------------
;  _01X
; ------------------------------------------------------------
_01x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _017
    ja undefined

    cmp al, 3
    jb short __01_012
    je  _013
    jmp short __01_456

    __01_012:
        cmp al, 1
        jb short _010
        je  _011
        jmp _012

    __01_456:
        cmp al, 5
        jb _014
        je  _015
        jmp _016

; ############################################################
_010:
    m_putsln '010'
    jmp _xxx

; ############################################################
_011:
    m_putsln '011'
    jmp _xxx

; ############################################################
_012:
    m_putsln '012'
    jmp _xxx

; ############################################################
_013:
    m_putsln '013'
    jmp _xxx

; ############################################################
_014:
    m_putsln '014'
    jmp _xxx

; ############################################################
_015:
    m_putsln '015'
    jmp _xxx

; ############################################################
_016:
    m_putsln '016'
    jmp _xxx

; ############################################################
_017:
    m_putsln '017'
    jmp _xxx

; ------------------------------------------------------------
;  _02X
; ------------------------------------------------------------
_02x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _027
    ja undefined

    cmp al, 3
    jb short __02_012
    je  _023
    jmp short __02_456

    __02_012:
        cmp al, 1
        jb short _020
        je  _021
        jmp _022

    __02_456:
        cmp al, 5
        jb _024
        je  _025
        jmp _026

; ############################################################
_020:
    m_putsln '020'
    jmp _xxx

; ############################################################
_021:
    m_putsln '021'
    jmp _xxx

; ############################################################
_022:
    m_putsln '022'
    jmp _xxx

; ############################################################
_023:
    m_putsln '023'
    jmp _xxx

; ############################################################
_024:
    m_putsln '024'
    jmp _xxx

; ############################################################
_025:
    m_putsln '025'
    jmp _xxx

; ############################################################
_026:
    m_putsln '026'
    jmp _xxx

; ############################################################
_027:
    m_putsln '027'
    jmp _xxx

; ------------------------------------------------------------
;  _03X
; ------------------------------------------------------------

_03x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _037
    ja undefined

    cmp al, 3
    jb short __03_012
    je  _033
    jmp short __03_456

    __03_012:
        cmp al, 1
        jb short _030
        je  _031
        jmp _032

    __03_456:
        cmp al, 5
        jb _034
        je  _035
        jmp _036

; ############################################################
_030:
    m_putsln '030'
    jmp _xxx

; ############################################################
_031:
    m_putsln '031'
    jmp _xxx

; ############################################################
_032:
    m_putsln '032'
    jmp _xxx

; ############################################################
_033:
    m_putsln '033'
    jmp _xxx

; ############################################################
_034:
    m_putsln '034'
    jmp _xxx

; ############################################################
_035:
    m_putsln '035'
    jmp _xxx

; ############################################################
_036:
    m_putsln '036'
    jmp _xxx

; ############################################################
_037:
    m_putsln '037'
    jmp _xxx

; ------------------------------------------------------------
;  _04X
; ------------------------------------------------------------
_04x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _047
    ja undefined

    cmp al, 3
    jb short __04_012
    je  _043
    jmp short __04_456

    __04_012:
        cmp al, 1
        jb short _040
        je  _041
        jmp _042

    __04_456:
        cmp al, 5
        jb _044
        je  _045
        jmp _046

; ############################################################
_040:
    m_putsln '040'
    jmp _xxx

; ############################################################
_041:
    m_putsln '041'
    jmp _xxx

; ############################################################
_042:
    m_putsln '042'
    jmp _xxx

; ############################################################
_043:
    m_putsln '043'
    jmp _xxx

; ############################################################
_044:
    m_putsln '044'
    jmp _xxx

; ############################################################
_045:
    m_putsln '045'
    jmp _xxx

; ############################################################
_046:
    m_putsln '046'
    jmp _xxx

; ############################################################
_047:
    m_putsln '047'
    jmp _xxx

; ------------------------------------------------------------
;  _05X
; ------------------------------------------------------------
_05x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _057
    ja undefined

    cmp al, 3
    jb short __05_012
    je  _053
    jmp short __05_456

    __05_012:
        cmp al, 1
        jb short _050
        je  _051
        jmp _052

    __05_456:
        cmp al, 5
        jb _054
        je  _055
        jmp _056

; ############################################################
_050:
    m_putsln '050'
    jmp _xxx

; ############################################################
_051:
    m_putsln '051'
    jmp _xxx

; ############################################################
_052:
    m_putsln '052'
    jmp _xxx

; ############################################################
_053:
    m_putsln '053'
    jmp _xxx

; ############################################################
_054:
    m_putsln '054'
    jmp _xxx

; ############################################################
_055:
    m_putsln '055'
    jmp _xxx

; ############################################################
_056:
    m_putsln '056'
    jmp _xxx

; ############################################################
_057:
    m_putsln '057'
    jmp _xxx

; ------------------------------------------------------------
;  _06X
; ------------------------------------------------------------

_06x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _067
    ja undefined

    cmp al, 3
    jb short __06_012
    je  _063
    jmp short __06_456

    __06_012:
        cmp al, 1
        jb short _060
        je  _061
        jmp _062

    __06_456:
        cmp al, 5
        jb _064
        je  _065
        jmp _066

; ############################################################
_060:
    m_putsln '060'
    jmp _xxx

; ############################################################
_061:
    m_putsln '061'
    jmp _xxx

; ############################################################
_062:
    m_putsln '062'
    jmp _xxx

; ############################################################
_063:
    m_putsln '063'
    jmp _xxx

; ############################################################
_064:
    m_putsln '064'
    jmp _xxx

; ############################################################
_065:
    m_putsln '065'
    jmp _xxx

; ############################################################
_066:
    m_putsln '066'
    jmp _xxx

; ############################################################
_067:
    m_putsln '067'
    jmp _xxx

; ------------------------------------------------------------
;  _07X
; ------------------------------------------------------------
_07x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _077
    ja undefined

    cmp al, 3
    jb short __07_012
    je  _073
    jmp short __07_456

    __07_012:
        cmp al, 1
        jb short _070
        je  _071
        jmp _072

    __07_456:
        cmp al, 5
        jb _074
        je  _075
        jmp _076

; ############################################################
_070:
    m_putsln '070'
    jmp _xxx

; ############################################################
_071:
    m_putsln '071'
    jmp _xxx

; ############################################################
_072:
    m_putsln '072'
    jmp _xxx

; ############################################################
_073:
    m_putsln '073'
    jmp _xxx

; ############################################################
_074:
    m_putsln '074'
    jmp _xxx

; ############################################################
_075:
    m_putsln '075'
    jmp _xxx

; ############################################################
_076:
    m_putsln '076'
    jmp _xxx

; ############################################################
_077:
    m_putsln '077'
    jmp _xxx

; ============================================================
;  _1XX
; ============================================================

_1xx:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _17x
    ja undefined_2nd_octal

    cmp al, 3
    jb short __1_012_x
    je  _13x
    jmp short __1_456_x

    __1_012_x:
        cmp al, 1
        jb short _10x
        je  _11x
        jmp _12x

    __1_456_x:
        cmp al, 6
        je _16x
        jmp undefined_2nd_octal ; _14x, _15x

; ------------------------------------------------------------
;  _10X
; ------------------------------------------------------------
_10x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _107
    ja undefined

    cmp al, 3
    jb short __10_012
    je  _103
    jmp short __10_456

    __10_012:
        cmp al, 1
        jb short _100
        je  _101
        jmp _102

    __10_456:
        cmp al, 5
        jb _104
        je  _105
        jmp _106

; ############################################################
_100:
    m_putsln '100'
    jmp _xxx

; ############################################################
_101:
    m_putsln '101'
    jmp _xxx

; ############################################################
_102:
    m_putsln '102'
    jmp _xxx

; ############################################################
_103:
    m_putsln '103'
    jmp _xxx

; ############################################################
_104:
    m_putsln '104'
    jmp _xxx

; ############################################################
_105:
    m_putsln '105'
    jmp _xxx

; ############################################################
_106:
    m_putsln '106'
    jmp _xxx

; ############################################################
_107:
    m_putsln '107'
    jmp _xxx

; ------------------------------------------------------------
;  _11X
; ------------------------------------------------------------
_11x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _117
    ja undefined

    cmp al, 3
    jb short __11_012
    je  _113
    jmp short __11_456

    __11_012:
        cmp al, 1
        jb short _110
        je  _111
        jmp _112

    __11_456:
        cmp al, 5
        jb _114
        je  _115
        jmp _116

; ############################################################
_110:
    m_putsln '110'
    jmp _xxx

; ############################################################
_111:
    m_putsln '111'
    jmp _xxx

; ############################################################
_112:
    m_putsln '112'
    jmp _xxx

; ############################################################
_113:
    m_putsln '113'
    jmp _xxx

; ############################################################
_114:
    m_putsln '114'
    jmp _xxx

; ############################################################
_115:
    m_putsln '115'
    jmp _xxx

; ############################################################
_116:
    m_putsln '116'
    jmp _xxx

; ############################################################
_117:
    m_putsln '117'
    jmp _xxx

; ------------------------------------------------------------
;  _12X
; ------------------------------------------------------------
_12x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _127
    ja undefined

    cmp al, 3
    jb short __12_012
    je  _123
    jmp short __12_456

    __12_012:
        cmp al, 1
        jb short _120
        je  _121
        jmp _122

    __12_456:
        cmp al, 5
        jb _124
        je  _125
        jmp _126

; ############################################################
_120:
    m_putsln '120'
    jmp _xxx

; ############################################################
_121:
    m_putsln '121'
    jmp _xxx

; ############################################################
_122:
    m_putsln '122'
    jmp _xxx

; ############################################################
_123:
    m_putsln '123'
    jmp _xxx

; ############################################################
_124:
    m_putsln '124'
    jmp _xxx

; ############################################################
_125:
    m_putsln '125'
    jmp _xxx

; ############################################################
_126:
    m_putsln '126'
    jmp _xxx

; ############################################################
_127:
    m_putsln '127'
    jmp _xxx

; ------------------------------------------------------------
;  _13X
; ------------------------------------------------------------

_13x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _137
    ja undefined

    cmp al, 3
    jb short __13_012
    je  _133
    jmp short __13_456

    __13_012:
        cmp al, 1
        jb short _130
        je  _131
        jmp _132

    __13_456:
        cmp al, 5
        jb _134
        je  _135
        jmp _136

; ############################################################
_130:
    m_putsln '130'
    jmp _xxx

; ############################################################
_131:
    m_putsln '131'
    jmp _xxx

; ############################################################
_132:
    m_putsln '132'
    jmp _xxx

; ############################################################
_133:
    m_putsln '133'
    jmp _xxx

; ############################################################
_134:
    m_putsln '134'
    jmp _xxx

; ############################################################
_135:
    m_putsln '135'
    jmp _xxx

; ############################################################
_136:
    m_putsln '136'
    jmp _xxx

; ############################################################
_137:
    m_putsln '137'
    jmp _xxx

; ------------------------------------------------------------
;  _16X
; ------------------------------------------------------------

_16x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _167
    ja undefined

    cmp al, 3
    jb short __16_012
    je  _163
    jmp short __16_456

    __16_012:
        cmp al, 1
        jb short _160
        je  _161
        jmp _162

    __16_456:
        cmp al, 5
        jb _164
        je  _165
        jmp _166

; ############################################################
_160:
    m_putsln '160'
    jmp _xxx

; ############################################################
_161:
    m_putsln '161'
    jmp _xxx

; ############################################################
_162:
    m_putsln '162'
    jmp _xxx

; ############################################################
_163:
    m_putsln '163'
    jmp _xxx

; ############################################################
_164:
    m_putsln '164'
    jmp _xxx

; ############################################################
_165:
    m_putsln '165'
    jmp _xxx

; ############################################################
_166:
    m_putsln '166'
    jmp _xxx

; ############################################################
_167:
    m_putsln '167'
    jmp _xxx

; ------------------------------------------------------------
;  _17X
; ------------------------------------------------------------
_17x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _177
    ja undefined

    cmp al, 3
    jb short __17_012
    je  _173
    jmp short __17_456

    __17_012:
        cmp al, 1
        jb short _170
        je  _171
        jmp _172

    __17_456:
        cmp al, 5
        jb _174
        je  _175
        jmp _176

; ############################################################
_170:
    m_putsln '170'
    jmp _xxx

; ############################################################
_171:
    m_putsln '171'
    jmp _xxx

; ############################################################
_172:
    m_putsln '172'
    jmp _xxx

; ############################################################
_173:
    m_putsln '173'
    jmp _xxx

; ############################################################
_174:
    m_putsln '174'
    jmp _xxx

; ############################################################
_175:
    m_putsln '175'
    jmp _xxx

; ############################################################
_176:
    m_putsln '176'
    jmp _xxx

; ############################################################
_177:
    m_putsln '177'
    jmp _xxx

; ============================================================
;  _2XX
; ============================================================
_2xx:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _27x_mov_reg_imm_word
    ja undefined_2nd_octal

    cmp al, 3
    jb short __2_012_x
    je  _23x
    jmp short __2_456_x

    __2_012_x:
        cmp al, 1
        jb short _20x
        je  _21x
        jmp _22x

    __2_456_x:
        cmp al, 5
        jb _24x
        je  _25x
        jmp _26x_mov_reg_imm_byte

; ------------------------------------------------------------
;  _20X
; ------------------------------------------------------------
_20x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _207
    ja undefined

    cmp al, 3
    jb short __20_012
    je  _203
    jmp short __20_456

    __20_012:
        cmp al, 1
        jb short _200
        je  _201
        jmp _202

    __20_456:
        cmp al, 5
        jb _204
        je  _205
        jmp _206

; ############################################################
_200:
    m_putsln '200'
    jmp _xxx

; ############################################################
_201:
    m_putsln '201'
    jmp _xxx

; ############################################################
_202:
    m_putsln '202'
    jmp _xxx

; ############################################################
_203:
    m_putsln '203'
    jmp _xxx

; ############################################################
_204:
    m_putsln '204'
    jmp _xxx

; ############################################################
_205:
    m_putsln '205'
    jmp _xxx

; ############################################################
_206:
    m_putsln '206'
    jmp _xxx

; ############################################################
_207:
    m_putsln '207'
    jmp _xxx

; ------------------------------------------------------------
;  _21X
; ------------------------------------------------------------

_21x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _217
    ja undefined

    cmp al, 3
    jb short __21_012
    je  _213
    jmp short __21_456

    __21_012:
        cmp al, 1
        jb short _210
        je  _211
        jmp _212

    __21_456:
        cmp al, 5
        jb _214
        je  _215
        jmp _216

; ############################################################
_210:
    m_putsln '210'
    jmp _xxx

; ############################################################
_211:
    m_putsln '211'
    jmp _xxx

; ############################################################
_212:
    m_putsln '212'
    jmp _xxx

; ############################################################
_213:
    m_putsln '213'
    jmp _xxx

; ############################################################
_214:
    m_putsln '214'
    jmp _xxx

; ############################################################
_215:
    m_putsln '215'
    jmp _xxx

; ############################################################
_216:
    m_putsln '216'
    jmp _xxx

; ############################################################
_217:
    m_putsln '217'
    jmp _xxx

; ------------------------------------------------------------
;  _22X
; ------------------------------------------------------------
_22x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _227
    ja undefined

    cmp al, 3
    jb short __22_012
    je  _223
    jmp short __22_456

    __22_012:
        cmp al, 1
        jb short _220
        je  _221
        jmp _222

    __22_456:
        cmp al, 5
        jb _224
        je  _225
        jmp _226

; ############################################################
_220:
    m_putsln '220'
    jmp _xxx

; ############################################################
_221:
    m_putsln '221'
    jmp _xxx

; ############################################################
_222:
    m_putsln '222'
    jmp _xxx

; ############################################################
_223:
    m_putsln '223'
    jmp _xxx

; ############################################################
_224:
    m_putsln '224'
    jmp _xxx

; ############################################################
_225:
    m_putsln '225'
    jmp _xxx

; ############################################################
_226:
    m_putsln '226'
    jmp _xxx

; ############################################################
_227:
    m_putsln '227'
    jmp _xxx

; ------------------------------------------------------------
;  _23X
; ------------------------------------------------------------
_23x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _237
    ja undefined

    cmp al, 3
    jb short __23_012
    je  _233
    jmp short __23_456

    __23_012:
        cmp al, 1
        jb short _230
        je  _231
        jmp _232

    __23_456:
        cmp al, 5
        jb _234
        je  _235
        jmp _236

; ############################################################
_230:
    m_putsln '230'
    jmp _xxx

; ############################################################
_231:
    m_putsln '231'
    jmp _xxx

; ############################################################
_232:
    m_putsln '232'
    jmp _xxx

; ############################################################
_233:
    m_putsln '233'
    jmp _xxx

; ############################################################
_234:
    m_putsln '234'
    jmp _xxx

; ############################################################
_235:
    m_putsln '235'
    jmp _xxx

; ############################################################
_236:
    m_putsln '236'
    jmp _xxx

; ############################################################
_237:
    m_putsln '237'
    jmp _xxx

; ------------------------------------------------------------
;  _24X
; ------------------------------------------------------------

_24x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _247
    ja undefined

    cmp al, 3
    jb short __24_012
    je  _243
    jmp short __24_456

    __24_012:
        cmp al, 1
        jb short _240
        je  _241
        jmp _242

    __24_456:
        cmp al, 5
        jb _244
        je  _245
        jmp _246

; ############################################################
_240:
    m_putsln '240'
    jmp _xxx

; ############################################################
_241:
    m_putsln '241'
    jmp _xxx

; ############################################################
_242:
    m_putsln '242'
    jmp _xxx

; ############################################################
_243:
    m_putsln '243'
    jmp _xxx

; ############################################################
_244:
    m_putsln '244'
    jmp _xxx

; ############################################################
_245:
    m_putsln '245'
    jmp _xxx

; ############################################################
_246:
    m_putsln '246'
    jmp _xxx

; ############################################################
_247:
    m_putsln '247'
    jmp _xxx

; ------------------------------------------------------------
;  _25X
; ------------------------------------------------------------

_25x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _257
    ja undefined

    cmp al, 3
    jb short __25_012
    je  _253
    jmp short __25_456

    __25_012:
        cmp al, 1
        jb short _250
        je  _251
        jmp _252

    __25_456:
        cmp al, 5
        jb _254
        je  _255
        jmp _256

; ############################################################
_250:
    m_putsln '250'
    jmp _xxx

; ############################################################
_251:
    m_putsln '251'
    jmp _xxx

; ############################################################
_252:
    m_putsln '252'
    jmp _xxx

; ############################################################
_253:
    m_putsln '253'
    jmp _xxx

; ############################################################
_254:
    m_putsln '254'
    jmp _xxx

; ############################################################
_255:
    m_putsln '255'
    jmp _xxx

; ############################################################
_256:
    m_putsln '256'
    jmp _xxx

; ############################################################
_257:
    m_putsln '257'
    jmp _xxx

; ************************************************************
;  _26X
; ************************************************************
_26x_mov_reg_imm_byte:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    ja undefined

    m_puts 'MOV '

    mov bl, al
    shl bl, 1; times 2. bl = 8

    ; --------- print register name -------------
    mov dl, byte ptr [Rb+bx+1]
    ;mov dl, byte ptr [Rb+9]
    mov ah, 02h
    int 21h

    mov dl, byte ptr [Rb+bx]
    ;mov dl, byte ptr [Rb+8]
    mov ah, 02h
    int 21h
    ; -------------------------------------------/

    m_puts ', '

    ; --------- print next byte -----------------
    inc si
    mov dl, byte ptr [data_octal+si]
    add dl, 30h
    mov ah, 02h
    int 21h

    inc si
    mov dl, byte ptr [data_octal+si]
    add dl, 30h
    mov ah, 02h
    int 21h

    inc si
    mov dl, byte ptr [data_octal+si]
    add dl, 30h
    mov ah, 02h
    int 21h
    ; -------------------------------------------/

    m_putsln '  <-- _26x_mov_reg_imm_byte'

    jmp _xxx

; ############################################################
;  _27X
; ############################################################
_27x_mov_reg_imm_word:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    ja undefined

    m_puts 'MOV '

    mov bl, al
    shl bl, 1; times 2. bl = 4

    ; --------- print register name -------------
    mov dl, byte ptr [Rw+bx+1]
    ;mov dl, byte ptr [Rw+9]
    mov ah, 02h
    int 21h

    mov dl, byte ptr [Rw+bx]
    ;mov dl, byte ptr [Rw+8]
    mov ah, 02h
    int 21h
    ; -------------------------------------------/

    m_puts ', '

    ; --------- print next word -----------------
    inc si
    mov dl, byte ptr [data_octal+si+3]
    add dl, 30h
    mov ah, 02h
    int 21h

    inc si
    mov dl, byte ptr [data_octal+si+3]
    add dl, 30h
    mov ah, 02h
    int 21h

    inc si
    mov dl, byte ptr [data_octal+si+3]
    add dl, 30h
    mov ah, 02h
    int 21h

    inc si
    mov dl, byte ptr [data_octal+si-3]
    add dl, 30h
    mov ah, 02h
    int 21h

    inc si
    mov dl, byte ptr [data_octal+si-3]
    add dl, 30h
    mov ah, 02h
    int 21h

    inc si
    mov dl, byte ptr [data_octal+si-3]
    add dl, 30h
    mov ah, 02h
    int 21h
    ; -------------------------------------------/

    m_putsln '  <-- _27x_mov_reg_imm_word'

    jmp _xxx

; ============================================================
;  _3XX
; ============================================================

_3xx:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _37x
    ja undefined_2nd_octal

    cmp al, 3
    jb short __3_012_x
    je  _33x
    jmp short __3_456_x

    __3_012_x:
        cmp al, 1
        jb short _30x
        je  _31x
        jmp _32x

    __3_456_x:
        cmp al, 5
        jb _34x
        je  _35x
        jmp _36x

; ------------------------------------------------------------
;  _30X
; ------------------------------------------------------------
_30x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _307
    ja undefined

    cmp al, 3
    jb short __30_012
    je  _303
    jmp short __30_456

    __30_012:
        cmp al, 2
        je _302
        jmp undefined ; _300, _301

    __30_456:
        cmp al, 5
        jb _304
        je  _305
        jmp _306

; ############################################################
_302:
    m_putsln '302'
    jmp _xxx

; ############################################################
_303:
    m_putsln '303'
    jmp _xxx

; ############################################################
_304:
    m_putsln '304'
    jmp _xxx

; ############################################################
_305:
    m_putsln '305'
    jmp _xxx

; ############################################################
_306:
    m_putsln '306'
    jmp _xxx

; ############################################################
_307:
    m_putsln '307'
    jmp _xxx

; ------------------------------------------------------------
;  _31X
; ------------------------------------------------------------
_31x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _317
    ja undefined

    cmp al, 3
    jb short __31_012
    je  _313
    jmp short __31_456

    __31_012:
        cmp al, 2
        je _312
        jmp undefined ; _310, _311

    __31_456:
        cmp al, 5
        jb _314
        je  _315
        jmp _316

; ############################################################
_312:
    m_putsln '312'
    jmp _xxx

; ############################################################
_313:
    m_putsln '313'
    jmp _xxx

; ############################################################
_314:
    m_putsln '314'
    jmp _xxx

; ############################################################
_315:
    m_putsln '315'
    jmp _xxx

; ############################################################
_316:
    m_putsln '316'
    jmp _xxx

; ############################################################
_317:
    m_putsln '317'
    jmp _xxx

; ------------------------------------------------------------
;  _32X
; ------------------------------------------------------------
_32x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _327
    ja undefined

    cmp al, 3
    jb short __32_012
    je  _323
    jmp short __32_456

    __32_012:
        cmp al, 1
        jb short _320
        je  _321
        jmp _322

    __32_456:
        cmp al, 5
        jb _324
        je  _325
        jmp undefined ; _326

; ############################################################
_320:
    m_putsln '320'
    jmp _xxx

; ############################################################
_321:
    m_putsln '321'
    jmp _xxx

; ############################################################
_322:
    m_putsln '322'
    jmp _xxx

; ############################################################
_323:
    m_putsln '323'
    jmp _xxx

; ############################################################
_324:
    m_putsln '324'
    jmp _xxx

; ############################################################
_325:
    m_putsln '325'
    jmp _xxx

; ############################################################
_327:
    m_putsln '327'
    jmp _xxx

; ------------------------------------------------------------
;  _33X
; ------------------------------------------------------------

_33x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _337
    ja undefined

    cmp al, 3
    jb short __33_012
    je  _333
    jmp short __33_456

    __33_012:
        cmp al, 1
        jb short _330
        je  _331
        jmp _332

    __33_456:
        cmp al, 5
        jb _334
        je  _335
        jmp _336

; ############################################################
_330:
    m_putsln '330'
    jmp _xxx

; ############################################################
_331:
    m_putsln '331'
    jmp _xxx

; ############################################################
_332:
    m_putsln '332'
    jmp _xxx

; ############################################################
_333:
    m_putsln '333'
    jmp _xxx

; ############################################################
_334:
    m_putsln '334'
    jmp _xxx

; ############################################################
_335:
    m_putsln '335'
    jmp _xxx

; ############################################################
_336:
    m_putsln '336'
    jmp _xxx

; ############################################################
_337:
    m_putsln '337'
    jmp _xxx

; ------------------------------------------------------------
;  _34X
; ------------------------------------------------------------
_34x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _347
    ja undefined

    cmp al, 3
    jb short __34_012
    je  _343
    jmp short __34_456

    __34_012:
        cmp al, 1
        jb short _340
        je  _341
        jmp _342

    __34_456:
        cmp al, 5
        jb _344
        je  _345
        jmp _346

; ############################################################
_340:
    m_putsln '340'
    jmp _xxx

; ############################################################
_341:
    m_putsln '341'
    jmp _xxx

; ############################################################
_342:
    m_putsln '342'
    jmp _xxx

; ############################################################
_343:
    m_putsln '343'
    jmp _xxx

; ############################################################
_344:
    m_putsln '344'
    jmp _xxx

; ############################################################
_345:
    m_putsln '345'
    jmp _xxx

; ############################################################
_346:
    m_putsln '346'
    jmp _xxx

; ############################################################
_347:
    m_putsln '347'
    jmp _xxx

; ------------------------------------------------------------
;  _35X
; ------------------------------------------------------------
_35x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _357
    ja undefined

    cmp al, 3
    jb short __35_012
    je  _353
    jmp short __35_456

    __35_012:
        cmp al, 1
        jb short _350
        je  _351
        jmp _352

    __35_456:
        cmp al, 5
        jb _354
        je  _355
        jmp _356

; ############################################################
_350:
    m_putsln '350'
    jmp _xxx

; ############################################################
_351:
    m_putsln '351'
    jmp _xxx

; ############################################################
_352:
    m_putsln '352'
    jmp _xxx

; ############################################################
_353:
    m_putsln '353'
    jmp _xxx

; ############################################################
_354:
    m_putsln '354'
    jmp _xxx

; ############################################################
_355:
    m_putsln '355'
    jmp _xxx

; ############################################################
_356:
    m_putsln '356'
    jmp _xxx

; ############################################################
_357:
    m_putsln '357'
    jmp _xxx

; ------------------------------------------------------------
;  _36X
; ------------------------------------------------------------

_36x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _367
    ja undefined

    cmp al, 3
    jb short __36_012
    je  _363
    jmp short __36_456

    __36_012:
        cmp al, 1
        jb _360
        ja _362
        jmp undefined ; _361

    __36_456:
        cmp al, 5
        jb _364
        je  _365
        jmp _366

; ############################################################
_360:
    m_putsln '360'
    jmp _xxx

; ############################################################
_361:
    m_putsln '361'
    jmp _xxx

; ############################################################
_362:
    m_putsln '362'
    jmp _xxx

; ############################################################
_363:
    m_putsln '363'
    jmp _xxx

; ############################################################
_364:
    m_putsln '364'
    jmp _xxx

; ############################################################
_365:
    m_putsln '365'
    jmp _xxx

; ############################################################
_366:
    m_putsln '366'
    jmp _xxx

; ############################################################
_367:
    m_putsln '367'
    jmp _xxx

; ------------------------------------------------------------
;  _37X
; ------------------------------------------------------------
_37x:
    inc si
    mov al, byte ptr [data_octal+si]

    cmp al, 7
    je _377
    ja undefined

    cmp al, 3
    jb short __37_012
    je  _373
    jmp short __37_456

    __37_012:
        cmp al, 1
        jb short _370
        je  _371
        jmp _372

    __37_456:
        cmp al, 5
        jb _374
        je  _375
        jmp _376

; ############################################################
_370:
    m_putsln '370'
    jmp _xxx

; ############################################################
_371:
    m_putsln '371'
    jmp _xxx

; ############################################################
_372:
    m_putsln '372'
    jmp _xxx

; ############################################################
_373:
    m_putsln '373'
    jmp _xxx

; ############################################################
_374:
    m_putsln '374'
    jmp _xxx

; ############################################################
_375:
    m_putsln '375'
    jmp _xxx

; ############################################################
_376:
    m_putsln '376'
    jmp _xxx

; ############################################################
_377:
    m_putsln '377'
    jmp _xxx
; -----------------------------------------------------------/

end start

